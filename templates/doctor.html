{% extends 'layout.html' %}

{% block content %}
{% if current_role %}
<div class="alert alert-info">
    You are logged in as <strong>{{ current_role|capitalize }}</strong>.
</div>
{% endif %}
<div class="container mt-4">
  {% if current_role == 'manager' %}
    <h3 class="mb-3">Add New Doctor</h3>
<form method="POST" action="{{ url_for('doctor.add_doctor') }}">
  <div class="form-row d-flex align-items-end">
    <div class="form-group col-md-2 pr-md-2">
      <label for="Doctor_ID" class="form-label">Doctor ID</label>
      <input type="text" class="form-control" id="Doctor_ID" name="Doctor_ID" required>
    </div>

    <div class="form-group col-md-2 px-md-2">
      <label for="Doctor_FName" class="form-label">First Name</label>
      <input type="text" class="form-control" id="Doctor_FName" name="Doctor_FName" required>
    </div>

    <div class="form-group col-md-2 px-md-2">
      <label for="Doctor_LName" class="form-label">Last Name</label>
      <input type="text" class="form-control" id="Doctor_LName" name="Doctor_LName" required>
    </div>

    <div class="form-group col-md-2 px-md-2">
      <label for="Department_ID" class="form-label">Department ID</label>
      <input type="text" class="form-control" id="Department_ID" name="Department_ID">
    </div>

    <div class="form-group col-md-2 px-md-2">
      <label for="Doctor_Contact_Number" class="form-label">Contact Number</label>
      <input type="text" class="form-control" id="Doctor_Contact_Number" name="Doctor_Contact_Number">
    </div>

    <div class="form-group col-md-1 px-md-2">
      <label for="Visit_Fee" class="form-label">Visit Fee</label>
      <input type="number" step="0.01" class="form-control" id="Visit_Fee" name="Visit_Fee">
    </div>

    <div class="form-group col-md-1 pl-md-2">
      <label for="Room_Num" class="form-label">Room No.</label>
      <input type="number" class="form-control" id="Room_Num" name="Room_Num">
    </div>
  </div>

  <div class="form-row mt-3 mb-5">
    <div class="form-group col-md-2">
      <button type="submit" class="btn btn-primary">Add Doctor</button>
    </div>
  </div>
</form>
 {% endif %}

    <h3 class="mb-3">Doctor List</h3>
    <table class="table table-bordered table-striped">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Department</th>
                <th>Contact</th>
                <th>Visit Fee</th>
                <th>Room</th>
                {% if current_role == 'manager' %}
                  <th>Action</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for doctor in doctors %}
            <tr>
                <td>{{ doctor.Doctor_ID }}</td>
                <td>{{ doctor.Doctor_FName }} {{ doctor.Doctor_LName }}</td>
                <td>{{ doctor.Department_ID }}</td>
                <td>{{ doctor.Doctor_Contact_Number }}</td>
                <td>{{ doctor.Visit_Fee }}</td>
                <td>{{ doctor.Room_Num }}</td>
                {% if current_role == 'manager' %}
                <td>
                    <form method="POST" action="{{ url_for('doctor.delete_doctor', doctor_id=doctor.Doctor_ID) }}" class="d-inline delete-form">
                        <button type="button" class="btn btn-link p-0 border-0 delete-btn" data-doctor-id="{{ doctor.Doctor_ID }}">
                            <img src="{{ url_for('static', filename='images/delete_icon.png') }}" alt="Delete" width="20" height="20">
                        </button>
                    </form>
                    <a href="{{ url_for('doctor.edit_doctor', doctor_id=doctor.Doctor_ID) }}" class="btn btn-sm btn-outline-primary custom-margin-left">Edit</a>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirm Delete</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this doctor?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Yes</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}
